toybox.ayatori-inc.co.jp {
	encode gzip

	# APIエンドポイント
	handle /api/* {
		reverse_proxy backend:4000 {
			transport http {
				read_timeout 30s
				write_timeout 30s
			}
		}
	}

	# アップロードファイル
	handle /uploads/* {
		reverse_proxy backend:4000 {
			transport http {
				read_timeout 60s
				write_timeout 60s
			}
		}
	}

	# ヘルスチェック
	handle /health {
		reverse_proxy backend:4000
	}

	# フロントエンド
	reverse_proxy frontend:3000 {
		transport http {
			read_timeout 30s
			write_timeout 30s
		}
	}
}

:4000 {
	encode gzip
	reverse_proxy backend:4000 {
		transport http {
			read_timeout 30s
			write_timeout 30s
		}
	}
}
